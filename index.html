<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root {
            --bg: #0b0e12;
            --card: #171a21;
            --accent: #0088cc;
            --gold: #ffca28;
            --green: #4caf50;
            --red: #ff4b4b;
            --text: #ffffff;
            --text-gray: #8e97a4;
        }

        body {
            background-color: var(--bg);
            color: var(--text);
            font-family: -apple-system, sans-serif;
            margin: 0; padding: 0;
            overflow-x: hidden;
            user-select: none;
        }

        /* 1. Splash Screen */
        #splash {
            position: fixed; top:0; left:0; width:100%; height:100%;
            background: var(--bg);
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            z-index: 1000; transition: 0.5s;
        }
        .logo { width: 120px; height: 120px; margin-bottom: 20px; }

        /* 2. Header & Online */
        .header { padding: 15px; display: flex; justify-content: space-between; align-items: center; }
        .online-box { display: flex; align-items: center; gap: 6px; font-size: 13px; color: var(--text-gray); }
        .online-dot { width: 6px; height: 6px; background: var(--green); border-radius: 50%; box-shadow: 0 0 8px var(--green); animation: blink 1.5s infinite; }
        
        .balance-card {
            background: var(--card); padding: 6px 12px; border-radius: 12px;
            display: flex; align-items: center; gap: 8px; border: 1px solid #2c3440;
        }

        /* 3. Live Drops */
        .live-drops {
            height: 50px; background: rgba(0,0,0,0.3); 
            display: flex; align-items: center; gap: 10px; padding: 0 10px;
            overflow: hidden; position: relative; border-bottom: 1px solid #1c212a;
        }
        .drop-item {
            min-width: 35px; height: 35px; background: var(--card);
            border-radius: 6px; display: flex; align-items: center; justify-content: center;
            border-bottom: 2px solid var(--accent);
            animation: slideIn 0.5s ease-out;
        }

        /* 4. Menu Items */
        .section-label { padding: 20px 15px 10px; font-size: 12px; color: var(--text-gray); text-transform: uppercase; letter-spacing: 1px; }
        .big-card {
            margin: 0 15px 15px; background: var(--card); padding: 20px;
            border-radius: 16px; display: flex; justify-content: space-between; align-items: center;
            border: 1px solid #242933; position: relative; overflow: hidden;
        }
        .free-case-btn { background: linear-gradient(90deg, #1e3c72, #2a5298); border: none; }

        /* 5. Deposit Modal */
        .modal {
            position: fixed; bottom: -100%; left: 0; width: 100%; height: 85%;
            background: var(--bg); z-index: 900; transition: 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            padding: 20px; box-sizing: border-box; border-top: 1px solid #2c3440;
            border-radius: 20px 20px 0 0;
        }
        .modal.active { bottom: 0; }
        .input-stars {
            width: 100%; background: var(--card); border: 2px solid #2c3440;
            padding: 20px; border-radius: 15px; color: var(--gold);
            font-size: 32px; text-align: center; outline: none; margin-bottom: 20px;
        }
        .input-stars:focus { border-color: var(--accent); }
        .pay-btn {
            width: 100%; padding: 18px; border-radius: 15px; border: none;
            font-size: 18px; font-weight: bold; color: white; background: #444; transition: 0.3s;
        }
        .pay-btn.enabled { background: var(--accent); box-shadow: 0 4px 15px rgba(0, 136, 204, 0.4); }

        @keyframes blink { 0% { opacity: 0.4; } 50% { opacity: 1; } 100% { opacity: 0.4; } }
        @keyframes slideIn { from { transform: translateX(50px); opacity: 0; } to { transform: translateX(0); opacity: 1; } }
    </style>
</head>
<body>

    <div id="splash">
        <img src="logo.png" class="logo" onerror="this.src='https://cdn-icons-png.flaticon.com/512/5968/5968804.png'">
        <div class="logo-placeholder">GIFT MARKET</div>
    </div>

    <div class="header">
        <div class="online-box">
            <div class="online-dot"></div>
            –û–Ω–ª–∞–π–Ω: <span id="online-count">1482</span>
        </div>
        <div class="balance-card" onclick="toggleModal('deposit-modal', true)">
            <img src="star.png" width="18" onerror="this.style.display='none'">
            <span>‚≠ê <span id="balance">0</span></span>
            <div style="margin-left:8px; color:var(--accent); font-weight:bold;">+</div>
        </div>
    </div>

    <div class="live-drops" id="live-drops"></div>

    <div class="section-label">–ê–∫—Ü–∏—è</div>
    <div class="big-card free-case-btn" onclick="openFreeCase()">
        <div>
            <div style="font-weight:bold; font-size:18px;">–ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π –∫–µ–π—Å</div>
            <div style="font-size:12px; opacity:0.8;">–ü–æ–¥–ø–∏—à–∏—Å—å –∏ –ø–æ–ª—É—á–∏ –ø–æ–¥–∞—Ä–æ–∫</div>
        </div>
        <div style="font-size:30px;">üéÅ</div>
    </div>

    <div class="section-label">–ò–≥—Ä—ã –∏ –∫–µ–π—Å—ã</div>
    <div class="big-card" onclick="alert('–°–∫–æ—Ä–æ!')">
        <div>üì¶ –í—Å–µ –∫–µ–π—Å—ã</div>
        <span>‚Üí</span>
    </div>
    <div class="big-card" style="border-left: 4px solid var(--red);" onclick="alert('–°–∫–æ—Ä–æ!')">
        <div>üöÄ –†–∞–∫–µ—Ç–∫–∞ (Crash)</div>
        <span style="color:var(--red);">LIVE</span>
    </div>

    <div id="deposit-modal" class="modal">
        <div style="display:flex; justify-content:space-between; margin-bottom:20px;">
            <h3 style="margin:0;">–ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ Stars</h3>
            <div onclick="toggleModal('deposit-modal', false)" style="font-size:24px; color:var(--text-gray);">‚úï</div>
        </div>
        
        <input type="number" id="star-input" class="input-stars" placeholder="0" oninput="validateInput()">
        
        <div style="display:grid; grid-template-columns: 1fr 1fr; gap:10px; margin-bottom:20px;">
            <button class="pay-btn enabled" style="font-size:14px; padding:10px;" onclick="setStars(200)">+200</button>
            <button class="pay-btn enabled" style="font-size:14px; padding:10px;" onclick="setStars(500)">+500</button>
            <button class="pay-btn enabled" style="font-size:14px; padding:10px;" onclick="setStars(1000)">+1000</button>
            <button class="pay-btn enabled" style="font-size:14px; padding:10px;" onclick="setStars(50)">MIN (50)</button>
        </div>

        <button id="pay-button" class="pay-btn" onclick="sendPayment()" disabled>–û–ü–õ–ê–¢–ò–¢–¨</button>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();

        // 1. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞—Å—Ç–∞–≤–∫–æ–π
        setTimeout(() => {
            document.getElementById('splash').style.opacity = '0';
            setTimeout(() => document.getElementById('splash').style.display = 'none', 500);
        }, 2000);

        // 2. –†–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–π –æ–Ω–ª–∞–π–Ω
        setInterval(() => {
            let count = parseInt(document.getElementById('online-count').innerText);
            let change = Math.floor(Math.random() * 5) - 2;
            document.getElementById('online-count').innerText = (count + change);
        }, 3000);

        // 3. –ñ–∏–≤–∞—è –ª–µ–Ω—Ç–∞ –¥—Ä–æ–ø–æ–≤
        const dropIcons = ['üåπ','üçì','üíç','üê∏','üèÜ','üö¨','üß§','üíé'];
        function addDrop() {
            const container = document.getElementById('live-drops');
            const item = document.createElement('div');
            item.className = 'drop-item';
            item.innerHTML = dropIcons[Math.floor(Math.random()*dropIcons.length)];
            container.prepend(item);
            if(container.children.length > 15) container.lastChild.remove();
        }
        setInterval(addDrop, 4000); // –ù–æ–≤—ã–π –¥—Ä–æ–ø –∫–∞–∂–¥—ã–µ 4 —Å–µ–∫
        for(let i=0; i<8; i++) addDrop();

        // 4. –õ–æ–≥–∏–∫–∞ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è
        function toggleModal(id, show) {
            document.getElementById(id).classList.toggle('active', show);
        }

        function setStars(val) {
            document.getElementById('star-input').value = val;
            validateInput();
        }

        function validateInput() {
            const val = parseInt(document.getElementById('star-input').value);
            const btn = document.getElementById('pay-button');
            if(val >= 50) {
                btn.classList.add('enabled');
                btn.disabled = false;
            } else {
                btn.classList.remove('enabled');
                btn.disabled = true;
            }
        }

        function sendPayment() {
            const val = document.getElementById('star-input').value;
            tg.sendData("pay:" + val);
            toggleModal('deposit-modal', false);
        }

        function openFreeCase() {
            tg.showPopup({
                title: "–ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π –∫–µ–π—Å",
                message: "–î–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è –ø–æ–¥–ø–∏—à–∏—Å—å –Ω–∞ –∫–∞–Ω–∞–ª—ã —Å–ø–æ–Ω—Å–æ—Ä–æ–≤ –≤ –±–æ—Ç–µ.",
                buttons: [{type: "ok"}]
            });
            tg.sendData("action:check_sub");
        }
    </script>
</body>
</html>
