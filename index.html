<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root {
            --bg: #0b0e12; --card: #171a21; --accent: #0088cc;
            --gold: #ffca28; --green: #4caf50; --red: #ff4b4b;
            --text: #ffffff; --text-gray: #8e97a4;
        }
        body { background-color: var(--bg); color: var(--text); font-family: -apple-system, sans-serif; margin: 0; padding: 0; overflow: hidden; user-select: none; height: 100vh; }
        
        /* Splash Screen */
        #splash { position: fixed; top:0; left:0; width:100%; height:100%; background: var(--bg); display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 1000; transition: 0.5s; }
        .splash-logo { width: 80px; height: 80px; margin-bottom: 15px; filter: drop-shadow(0 0 10px var(--accent)); }

        /* Header */
        .header { padding: 15px; display: flex; justify-content: space-between; align-items: center; }
        .online-box { display: flex; align-items: center; gap: 6px; font-size: 13px; color: var(--text-gray); }
        .online-dot { width: 6px; height: 6px; background: var(--green); border-radius: 50%; box-shadow: 0 0 8px var(--green); animation: blink 1.5s infinite; }
        .balance-card { background: var(--card); padding: 8px 15px; border-radius: 25px; display: flex; align-items: center; gap: 8px; border: 1px solid #2c3440; }

        /* Live Drops */
        .live-drops { height: 60px; background: rgba(0,0,0,0.3); display: flex; align-items: center; gap: 10px; padding: 0 10px; overflow: hidden; border-bottom: 1px solid #1c212a; }
        .drop-item { min-width: 45px; height: 45px; background: var(--card); border-radius: 8px; display: flex; align-items: center; justify-content: center; border-bottom: 2px solid var(--accent); animation: slideIn 0.5s ease-out; }
        .drop-item img { width: 32px; height: 32px; object-fit: contain; }

        /* Main Content */
        .section-label { padding: 20px 15px 10px; font-size: 11px; color: var(--text-gray); text-transform: uppercase; letter-spacing: 1px; }
        .big-card { margin: 0 15px 12px; background: var(--card); padding: 18px; border-radius: 16px; display: flex; justify-content: space-between; align-items: center; border: 1px solid #242933; transition: 0.2s; }
        .big-card:active { transform: scale(0.98); background: #1c212a; }
        .free-btn { background: linear-gradient(135deg, #1e3c72, #2a5298); border: none; box-shadow: 0 4px 15px rgba(30, 60, 114, 0.4); }
        .card-img { width: 55px; height: 55px; object-fit: contain; }

        /* Modals */
        .modal-screen { position: fixed; bottom: -100%; left: 0; width: 100%; height: 100%; background: var(--bg); z-index: 900; transition: 0.4s cubic-bezier(0.4, 0, 0.2, 1); padding: 20px; box-sizing: border-box; display: flex; flex-direction: column; }
        .modal-screen.active { bottom: 0; }
        .close-area { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        
        /* Inputs */
        .input-container { margin: 20px 0; background: #1c212a; border: 2px solid #2c3440; border-radius: 15px; padding: 5px; }
        .input-stars { width: 100%; background: transparent; border: none; color: var(--gold); font-size: 32px; text-align: center; outline: none; padding: 10px; font-weight: bold; }

        .pay-btn { width: 100%; padding: 18px; border-radius: 15px; border: none; font-size: 18px; font-weight: bold; color: white; background: #2c3440; cursor: pointer; }
        .pay-btn.enabled { background: var(--accent); }

        @keyframes blink { 0%, 100% { opacity: 0.4; } 50% { opacity: 1; } }
        @keyframes slideIn { from { transform: translateX(40px); opacity: 0; } to { transform: translateX(0); opacity: 1; } }
    </style>
</head>
<body>

    <div id="splash">
        <img src="https://img.icons8.com/color/512/gift--v1.png" class="splash-logo">
        <div style="font-weight:bold; letter-spacing:3px; color:var(--accent);">GIFT MARKET</div>
    </div>

    <div class="header">
        <div class="online-box"><div class="online-dot"></div>–û–Ω–ª–∞–π–Ω: <span id="online-count">1482</span></div>
        <div class="balance-card" onclick="openModal('deposit-screen')">‚≠ê <span id="balance">0</span> <span style="color:var(--accent); font-weight:bold; font-size:20px;">+</span></div>
    </div>

    <div class="live-drops" id="live-drops"></div>

    <div class="section-label">–≠–∫—Å–∫–ª—é–∑–∏–≤–Ω—ã–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è</div>
    <div class="big-card free-btn" onclick="openModal('free-case-screen')">
        <div><b style="font-size:18px;">–ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π –∫–µ–π—Å</b><br><small style="opacity:0.8;">–ó–∞ –ø–æ–¥–ø–∏—Å–∫—É –Ω–∞ —Å–ø–æ–Ω—Å–æ—Ä–æ–≤</small></div>
        <img src="https://img.icons8.com/color/512/gift--v1.png" class="card-img">
    </div>

    <div class="section-label">–ú–∞–≥–∞–∑–∏–Ω –ø–æ–¥–∞—Ä–∫–æ–≤</div>
    <div class="big-card" onclick="alert('–ú–∞–≥–∞–∑–∏–Ω –æ—Ç–∫—Ä–æ–µ—Ç—Å—è —Å–∫–æ—Ä–æ!')">
        <div><b>–ù–∞–±–æ—Ä—ã –ø–æ–¥–∞—Ä–∫–æ–≤</b><br><small style="color:var(--text-gray);">–ö–æ–ª–ª–µ–∫—Ü–∏–∏ 2024</small></div>
        <img src="https://img.icons8.com/color/512/box.png" class="card-img" style="width:45px;">
    </div>

    <div class="big-card" style="border-left: 4px solid var(--red);">
        <div><b>Premium –†–æ–∑—ã–≥—Ä—ã—à</b><br><small style="color:var(--red);">–£–∂–µ –∏–¥–µ—Ç!</small></div>
        <img src="https://img.icons8.com/color/512/christmas-star.png" class="card-img" style="width:45px;">
    </div>

    <div id="deposit-screen" class="modal-screen">
        <div class="close-area"><h3>–ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ Stars</h3><div onclick="closeModal('deposit-screen')" style="font-size:28px;">‚úï</div></div>
        <div class="input-container">
            <input type="number" id="star-input" class="input-stars" placeholder="0" oninput="validateInput()">
        </div>
        <button id="pay-button" class="pay-btn" onclick="sendPayment()" disabled>–ö–£–ü–ò–¢–¨ –ó–í–ï–ó–î–´</button>
        <p style="text-align:center; color:var(--text-gray); font-size:12px; margin-top:15px;">–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—É–º–º–∞: 50 ‚≠ê</p>
    </div>

    <div id="free-case-screen" class="modal-screen">
        <div class="close-area"><div onclick="closeModal('free-case-screen')" style="font-size:28px;">‚Üê</div><h3 style="margin:0;">–ë–ï–°–ü–õ–ê–¢–ù–´–ô –ö–ï–ô–°</h3><div></div></div>
        <div style="text-align:center; padding: 20px 0;">
            <img src="https://img.icons8.com/color/512/gift--v1.png" style="width:120px; filter: drop-shadow(0 10px 20px rgba(0,0,0,0.5));">
            <p style="color:var(--text-gray); margin-top:20px;">–î–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è –ø–æ–¥–ø–∏—à–∏—Å—å –Ω–∞ –∫–∞–Ω–∞–ª—ã:</p>
        </div>
        <div id="sponsor-list" style="flex-grow:1; overflow-y:auto;">
            </div>
        <button class="pay-btn enabled" onclick="confirmSub()">–ü–†–û–í–ï–†–ò–¢–¨ –ò –û–¢–ö–†–´–¢–¨</button>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();
        tg.enableClosingConfirmation();

        // –°—Å—ã–ª–∫–∏ –Ω–∞ –∫–∞—Ä—Ç–∏–Ω–∫–∏ (–ü–æ–¥–∞—Ä–∫–∏ –∏ –ì–∏—Ñ—Ç—ã)
        const assets = [
            'https://img.icons8.com/color/512/red-rose.png',
            'https://img.icons8.com/color/512/diamond--v1.png',
            'https://img.icons8.com/color/512/champagne-bottle.png',
            'https://img.icons8.com/color/512/trophy.png',
            'https://img.icons8.com/color/512/star--v1.png',
            'https://img.icons8.com/color/512/strawberry.png',
            'https://img.icons8.com/color/512/ruby--v1.png',
            'https://img.icons8.com/color/512/crown.png'
        ];

        // –£–±–∏—Ä–∞–µ–º Splash
        setTimeout(() => { 
            document.getElementById('splash').style.opacity = '0';
            setTimeout(() => document.getElementById('splash').style.display = 'none', 500);
        }, 2000);

        // –ñ–∏–≤–æ–π –æ–Ω–ª–∞–π–Ω
        setInterval(() => {
            let el = document.getElementById('online-count');
            el.innerText = parseInt(el.innerText) + (Math.floor(Math.random() * 5) - 2);
        }, 3000);

        // –õ–µ–Ω—Ç–∞ –¥—Ä–æ–ø–æ–≤
        function addDrop() {
            const container = document.getElementById('live-drops');
            const item = document.createElement('div');
            item.className = 'drop-item';
            const randomImg = assets[Math.floor(Math.random() * assets.length)];
            item.innerHTML = `<img src="${randomImg}">`;
            container.prepend(item);
            if(container.children.length > 12) container.lastChild.remove();
        }
        setInterval(addDrop, 3500);
        for(let i=0; i<8; i++) addDrop();

        // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–æ–¥–∞–ª–∫–∞–º–∏
        function openModal(id) { document.getElementById(id).classList.add('active'); }
        function closeModal(id) { document.getElementById(id).classList.remove('active'); }

        function validateInput() {
            const val = document.getElementById('star-input').value;
            const btn = document.getElementById('pay-button');
            btn.disabled = val < 50;
            btn.classList.toggle('enabled', val >= 50);
        }

        function sendPayment() { tg.sendData("pay:" + document.getElementById('star-input').value); }
        function confirmSub() { tg.sendData("action:check_sub"); }

        // –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ —Å–ø–æ–Ω—Å–æ—Ä—ã
        function renderSponsors() {
            const container = document.getElementById('sponsor-list');
            const params = new URLSearchParams(window.location.search);
            const spData = params.get('sp');
            if(spData) {
                spData.split('|').forEach(data => {
                    const [name, link] = data.split(';');
                    const card = document.createElement('div');
                    card.className = 'big-card';
                    card.onclick = () => tg.openTelegramLink(link);
                    card.innerHTML = `<span>üì¢ ${name}</span><span style="color:var(--accent); font-weight:bold;">–ü–û–î–ü–ò–°–ê–¢–¨–°–Ø</span>`;
                    container.appendChild(card);
                });
            } else {
                container.innerHTML = '<p style="text-align:center; color:var(--text-gray); margin-top:20px;">–°–ø–æ–Ω—Å–æ—Ä–æ–≤ –ø–æ–∫–∞ –Ω–µ—Ç</p>';
            }
        }
        renderSponsors();
    </script>
</body>
</html>
