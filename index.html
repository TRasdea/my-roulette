<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root {
            --bg-color: #0f1218;
            --card-bg: #1c212a;
            --accent: #0088cc;
            --text-main: #ffffff;
        }

        body {
            background-color: var(--bg-color);
            /* –ü–∞—Ç—Ç–µ—Ä–Ω "–ª–∞–ø–∫–∏" –∏–ª–∏ –º–µ–ª–∫–∏–µ –∑–Ω–∞—á–∫–∏ –Ω–∞ —Ñ–æ–Ω–µ */
            background-image: url('https://www.transparenttextures.com/patterns/carbon-fibre.png');
            color: var(--text-main);
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            margin: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            overflow: hidden;
        }

        .roulette-container {
            position: relative;
            width: 100%;
            max-width: 640px;
            height: 180px;
            background: var(--card-bg);
            border-top: 2px solid #2c3440;
            border-bottom: 2px solid #2c3440;
            overflow: hidden;
            display: flex;
            align-items: center;
        }

        /* –ö—Ä–∞—Å–Ω–∞—è –ª–∏–Ω–∏—è-—É–∫–∞–∑–∞—Ç–µ–ª—å */
        .pointer {
            position: absolute;
            left: 50%;
            top: 0;
            bottom: 0;
            width: 3px;
            background: #ff4b4b;
            z-index: 10;
            box-shadow: 0 0 15px rgba(255, 75, 75, 0.5);
            transform: translateX(-50%);
        }

        .tape {
            display: flex;
            transition: transform 5s cubic-bezier(0.15, 0, 0.15, 1);
            will-change: transform;
            padding-left: 50%;
        }

        .gift-card {
            min-width: 130px;
            height: 150px;
            margin: 0 5px;
            background: #242a35;
            border-radius: 12px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            border: 1px solid #343d4c;
            position: relative;
        }

        .gift-card img {
            width: 70px;
            height: 70px;
            margin-bottom: 10px;
        }

        .gift-card .name {
            font-size: 12px;
            font-weight: 600;
            color: #8e97a4;
        }

        .gift-card .price {
            font-size: 14px;
            color: #ffca28;
            margin-top: 5px;
        }

        .btn-spin {
            margin-top: 40px;
            background: var(--accent);
            color: white;
            border: none;
            padding: 18px 60px;
            font-size: 18px;
            font-weight: bold;
            border-radius: 15px;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(0, 136, 204, 0.4);
        }

        .btn-spin:disabled { background: #444; cursor: not-allowed; }
    </style>
</head>
<body>

    <h2 style="margin-bottom: 30px;">GIFT MARKET</h2>

    <div class="roulette-container">
        <div class="pointer"></div>
        <div class="tape" id="tape">
            </div>
    </div>

    <button class="btn-spin" id="spinBtn" onclick="spin()">–ö–†–£–¢–ò–¢–¨</button>

<script>
    const tg = window.Telegram.WebApp;
    tg.expand();

    const items = [
        {name: '–û—Å–∫–∞—Ä', img: 'üèÜ', price: '10 445'},
        {name: '–ü–µ–ø–µ', img: 'üê∏', price: '756 391'},
        {name: '–†–æ–∑–∞', img: 'üåπ', price: '2 587'},
        {name: '–ö–ª—É–±–Ω–∏–∫–∞', img: 'üçì', price: '841'},
        {name: '–ö–æ–ª—å—Ü–æ', img: 'üíç', price: '3 590'},
        {name: '–®–ª–µ–º', img: 'ü™ñ', price: '84 043'},
        {name: '–°–∏–≥–∞—Ä–∞', img: 'üö¨', price: '1 108'}
    ];

    const tape = document.getElementById('tape');
    const spinBtn = document.getElementById('spinBtn');

    // –°–æ–∑–¥–∞–µ–º –¥–ª–∏–Ω–Ω—É—é –ª–µ–Ω—Ç—É –¥–ª—è –ø—Ä–æ–∫—Ä—É—Ç–∫–∏
    function initTape() {
        for (let i = 0; i < 60; i++) {
            const item = items[Math.floor(Math.random() * items.length)];
            const card = document.createElement('div');
            card.className = 'gift-card';
            card.innerHTML = `
                <div style="font-size: 40px;">${item.img}</div>
                <div class="name">${item.name}</div>
                <div class="price">‚≠ê ${item.price}</div>
            `;
            tape.appendChild(card);
        }
    }

    function spin() {
        spinBtn.disabled = true;
        const cardWidth = 140; // —à–∏—Ä–∏–Ω–∞ + –æ—Ç—Å—Ç—É–ø—ã
        const winnerIndex = 45; // –ö–∞–∫–æ–π –ø–æ —Å—á–µ—Ç—É –ø—Ä–µ–¥–º–µ—Ç –≤—ã–∏–≥—Ä–∞–µ—Ç
        const offset = (winnerIndex * cardWidth) + (Math.random() * 100 - 50);
        
        tape.style.transform = `translateX(-${offset}px)`;

        setTimeout(() => {
            const winner = items[Math.floor(Math.random() * items.length)];
            
            // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –±–æ—Ç—É
            if (tg.sendData) {
                tg.sendData("win:" + winner.name);
            }

            // –ó–∞–∫—Ä—ã–≤–∞–µ–º —á–µ—Ä–µ–∑ —Å–µ–∫—É–Ω–¥—É –ø–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö
            setTimeout(() => {
                tg.close();
            }, 1500);
            
        }, 5100);
    }

    initTape();
</script>
</body>
</html>
